# Расчет поковок кольцо раскатное

Веб-приложение на ASP.NET Core для расчета параметров поковок кольцо раскатное на основе математической модели. Приложение выполняет расчет размеров заготовки, допусков и массы поковки с визуализацией результатов в виде технических чертежей.

## Технологии

- **ASP.NET Core 8.0** (MVC)
- **C# 12**
- **Bootstrap 5** (для UI)
- **SVG** (для визуализации чертежей)
- **Session** (для сохранения результатов)

## Структура проекта

```
asp-project/
├── Controllers/
│   └── CalculationController.cs      # Контроллер для расчетов
├── Models/
│   ├── CalculationInputModel.cs      # Модель входных данных
│   ├── CalculationResult.cs          # Модель результатов
│   └── ViewModels/
│       └── ResultViewModel.cs        # ViewModel для страницы результатов
├── Services/
│   ├── ICalculationService.cs        # Интерфейс сервиса расчета
│   ├── CalculationService.cs         # Реализация сервиса расчета
│   ├── IDrawingService.cs            # Интерфейс сервиса визуализации
│   └── DrawingService.cs             # Реализация сервиса визуализации
├── Views/
│   ├── _ViewImports.cshtml           # Импорты для всех представлений
│   ├── Calculation/
│   │   ├── Index.cshtml              # Форма для ввода данных
│   │   └── Result.cshtml             # Страница с результатами расчета
│   └── Shared/
│       ├── _Layout.cshtml            # Общий макет приложения
│       ├── _ViewStart.cshtml         # Установка макета по умолчанию
│       └── _ValidationScriptsPartial.cshtml  # Скрипты валидации
├── wwwroot/
│   └── css/
│       └── site.css                  # Стили приложения
├── Program.cs                        # Точка входа
├── appsettings.json                  # Конфигурация
└── asp-project.csproj                # Файл проекта
```

## Установка и запуск

### Требования

- .NET 8.0 SDK или выше
- Windows, Linux или macOS

### Шаги установки

1. Убедитесь, что у вас установлен .NET 8.0 SDK:
   ```bash
   dotnet --version
   ```

2. Запустите приложение:
   ```bash
   dotnet run
   ```

3. Откройте браузер и перейдите по адресу:
   ```
   http://localhost:5000
   ```
   
   Приложение автоматически перенаправит на страницу `/calculation`

## Использование

1. На главной странице заполните форму с параметрами поковки:
   - **D** - Наружный диаметр детали (мм)
   - **d** - Внутренний диаметр детали (мм)
   - **H** - Высота детали (мм)
   - **X** - Количество деталей в поковке
   - **Y** - Длина реза (мм)
   - **Z** - Количество резов
   - **Q** - Напуск на пробу (мм)
   - **Напуск на термообработку** (мм)
   - **Удельный вес стали** (г/см³, по умолчанию 7.85)

2. Нажмите кнопку "Выполнить расчет"

3. На странице результатов вы увидите:
   - **Входные параметры** - все введенные данные
   - **Промежуточные расчеты** - H1 и H2 с формулами
   - **Размеры поковки** - детальные размеры с допусками
   - **Размеры заготовки** - отдельно для вариантов без пробы и с пробой
   - **Расчет массы** - номинальная и максимальная масса для обоих вариантов
   - **Чертежи поковки** - SVG-чертежи для обоих вариантов
   
   Результаты сохраняются в сессии на 30 минут, поэтому можно обновить страницу без потери данных.

## Формулы расчета

Приложение реализует следующие формулы из математической модели:

### Промежуточные расчеты:
- **H1** = H × X + (Y × Z) + напуск на ТО (высота заготовки без пробы)
- **H2** = H × X + (Y × Z) + Q + напуск на ТО (высота заготовки с пробой)

### Размеры детали:
- **D дет** = D + напуск на ТО
- **d дет** = d - напуск на ТО

### Размеры заготовки:
- **D заг** = D + β ± Δ/2
- **d заг** = d дет - β ± 3β
- **H заг** = H1 (без пробы) или H2 (с пробой) ± Δ/2

### Коэффициенты допусков (по ГОСТ):
- **β** (для диаметров): зависит от размера (1.0 - 2.5)
- **β** (для высот): зависит от размера (1.0 - 2.0)
- **Δ/2** = β / 2

### Масса поковки:
- **V** = π × (R²внешний - R²внутренний) × H
- **m** = ρ × V / 1000 (в тоннах)
- Рассчитывается номинальная и максимальная масса

## Особенности

### Валидация данных:
- ✅ **Клиентская валидация** - HTML5 атрибуты и jQuery Validation
- ✅ **Серверная валидация** - Data Annotations с проверкой диапазонов
- ✅ **Визуальная обратная связь** - выделение полей с ошибками
- ✅ **Нормализация данных** - автоматическая замена запятой на точку
- ✅ **Автоматическая прокрутка** к первому полю с ошибкой

### Расчеты:
- ✅ Расчет размеров заготовки с учетом допусков по ГОСТ
- ✅ Расчет массы поковки (номинальной и максимальной)
- ✅ Поддержка вариантов с пробой и без пробы
- ✅ Детальные расчеты для диска и отверстия

### Визуализация:
- ✅ SVG-чертежи поковки с размерами
- ✅ Отображение размеров детали и заготовки
- ✅ Техническая информация на чертеже

### Удобство использования:
- ✅ Сохранение результатов в сессии (30 минут)
- ✅ Возможность обновить страницу без потери данных
- ✅ Адаптивный дизайн для разных устройств
- ✅ Значения по умолчанию для быстрого старта

## Валидация полей

Все поля имеют ограничения по диапазону:

| Поле | Диапазон | Обязательное |
|------|----------|--------------|
| D (Наружный диаметр) | 1 - 10000 мм | Да |
| d (Внутренний диаметр) | 1 - 10000 мм | Да |
| H (Высота) | 1 - 10000 мм | Да |
| X (Количество деталей) | 1 - 100 | Да |
| Y (Длина реза) | 0 - 1000 мм | Да |
| Z (Количество резов) | 0 - 100 | Да |
| Q (Напуск на пробу) | 0 - 1000 мм | Да |
| Напуск на ТО | 0 - 1000 мм | Нет |
| Удельный вес стали | 0.1 - 20 г/см³ | Нет |

## Архитектура

Приложение использует паттерн MVC (Model-View-Controller):

- **Controllers** - обработка HTTP-запросов и координация работы
- **Services** - бизнес-логика расчетов и генерация чертежей
- **Models** - модели данных и ViewModels
- **Views** - Razor-представления для отображения

## Дальнейшее развитие

Возможные улучшения:
- Экспорт результатов в PDF/Excel
- Интеграция с базой данных для сохранения истории расчетов
- API для интеграции с другими системами
- Более детальная визуализация с интерактивными элементами
- Загрузка коэффициентов допусков из конфигурационного файла

## Лицензия

Проект создан для внутреннего использования.